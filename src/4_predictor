import numpy as np
from tensorflow.keras.models import load_model

from utils import load_data

LABELS = {0: "Upper part", 1: "Bottom part", 2: "One piece", 3: "Footwear", 4: "Bags"}


if __name__ == '__main__':
    # Load data
    train_x, train_y, test_x, test_y = load_data()

    # Load keras model
    model = load_model('../models/keras_model.h5')

    while True:

        # Enter id of sample to predict with keyboard
        try:
            sample_id = int(input("Enter sample id to predict: "))
        except ValueError:
            print("Invalid id. The id must be a whole number\n\n")
            continue


        # Add batch dimension
        sample = np.expand_dims(test_x[sample_id], axis=0)

        # Predict
        y_pred = model.predict(sample, verbose=0)

        true_label = LABELS[np.argmax(test_y[sample_id])]
        pred_label = LABELS[np.argmax(y_pred)]

        print(f"True label: {true_label:>10}")
        print(f"Predicted label: {pred_label}\n\n")
